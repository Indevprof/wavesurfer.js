/*!
 * wavesurfer.js markers plugin 5.2.0 (2022-01-31)
 * https://wavesurfer-js.org
 * @license BSD-3-Clause
 */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("WaveSurfer",[],r):"object"==typeof exports?exports.WaveSurfer=r():(e.WaveSurfer=e.WaveSurfer||{},e.WaveSurfer.markers=r())}(self,(function(){return(()=>{"use strict";var e={188:(e,r)=>{function t(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(){function e(r,t){var i=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=r,this.wavesurfer=t,this.util=t.util,this.style=this.util.style,this.markerLineWidth=1,this.markerWidth=11,this.markerHeight=22,this.dragging=!1,this._onResize=function(){i._updateMarkerPositions()},this._onBackendCreated=function(){i.wrapper=i.wavesurfer.drawer.wrapper,i.params.markers&&i.params.markers.forEach((function(e){return i.add(e)})),window.addEventListener("resize",i._onResize,!0),window.addEventListener("orientationchange",i._onResize,!0),i.wavesurfer.on("zoom",i._onResize),i.markers.find((function(e){return e.draggable}))&&(i.onMouseMove=function(e){return i._onMouseMove(e)},window.addEventListener("mousemove",i.onMouseMove),i.onMouseUp=function(e){return i._onMouseUp(e)},window.addEventListener("mouseup",i.onMouseUp))},this.markers=[],this._onReady=function(){i.wrapper=i.wavesurfer.drawer.wrapper,i._updateMarkerPositions()}}var r,i,a;return r=e,a=[{key:"create",value:function(r){return{name:"markers",deferInit:!(!r||!r.deferInit)&&r.deferInit,params:r,staticProps:{addMarker:function(e){return this.initialisedPluginList.markers||this.initPlugin("markers"),this.markers.add(e)},clearMarkers:function(){this.markers&&this.markers.clear()}},instance:e}}}],(i=[{key:"init",value:function(){this.wavesurfer.isReady?(this._onBackendCreated(),this._onReady()):(this.wavesurfer.once("ready",this._onReady),this.wavesurfer.once("backend-created",this._onBackendCreated))}},{key:"destroy",value:function(){this.wavesurfer.un("ready",this._onReady),this.wavesurfer.un("backend-created",this._onBackendCreated),this.wavesurfer.un("zoom",this._onResize),window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0),this.onMouseMove&&window.removeEventListener("mousemove",this.onMouseMove),this.onMouseUp&&window.removeEventListener("mouseup",this.onMouseUp),this.clear()}},{key:"add",value:function(e){var r={time:e.time,label:e.label,color:e.color||"#D8D8D8",position:e.position||"bottom",draggable:!!e.draggable,labelColor:e.labelColor,labelBackground:e.labelBackground,lineColor:e.lineColor,noMarker:e.noMarker};return r.el=this._createMarkerElement(r,e.markerElement),this.wrapper.appendChild(r.el),this.markers.push(r),this._updateMarkerPositions(),r}},{key:"remove",value:function(e){var r=this.markers[e];r&&(this.wrapper.removeChild(r.el),this.markers.splice(e,1))}},{key:"_createPointerSVG",value:function(e,r){var t="http://www.w3.org/2000/svg",i=document.createElementNS(t,"svg"),a=document.createElementNS(t,"polygon");return i.setAttribute("viewBox","0 0 40 80"),a.setAttribute("id","polygon"),a.setAttribute("stroke","#979797"),a.setAttribute("fill",e),a.setAttribute("points","20 0 40 30 40 80 0 80 0 30"),"top"==r&&a.setAttribute("transform","rotate(180, 20 40)"),i.appendChild(a),this.style(i,{width:this.markerWidth+"px",height:this.markerHeight+"px","min-width":this.markerWidth+"px","margin-right":"5px","z-index":4}),i}},{key:"_createMarkerElement",value:function(e,r){var t=this,i=e.label,a=document.createElement("marker");a.className="wavesurfer-marker",this.style(a,{position:"absolute",height:"100%",display:"flex",overflow:"hidden","flex-direction":"top"==e.position?"column-reverse":"column"});var n=document.createElement("div"),s=r?r.width:this.markerWidth;e.offset=(s-this.markerLineWidth)/2,this.style(n,{"flex-grow":1,"margin-left":e.offset+"px",background:"black",width:this.markerLineWidth+"px"}),a.appendChild(n);var o=document.createElement("div");if(!e.noMarker){var u=r||this._createPointerSVG(e.color,e.position);e.draggable&&(u.draggable=!1),o.appendChild(u)}if(i){var d=document.createElement("span");d.innerText=i,this.style(d,{"font-family":"monospace","font-size":"90%",color:e.labelColor||"black",background:e.labelBackground,padding:"2px",margin:"2px","z-index":"5","border-radius":"4px"}),o.appendChild(d)}return this.style(o,{display:"flex","align-items":"center",cursor:"pointer"}),a.appendChild(o),o.addEventListener("click",(function(r){r.stopPropagation(),t.dragging||(t.wavesurfer.setCurrentTime(e.time),t.wavesurfer.fireEvent("marker-click",e,r))})),e.draggable&&o.addEventListener("mousedown",(function(r){t.selectedMarker=e})),a}},{key:"_updateMarkerPositions",value:function(){for(var e=0;e<this.markers.length;e++){var r=this.markers[e];this._updateMarkerPosition(r)}}},{key:"_updateMarkerPosition",value:function(e){var r=this.wavesurfer.getDuration(),t=this.wavesurfer.drawer.width/this.wavesurfer.params.pixelRatio,i=t*Math.min(e.time/r,1)-e.offset;this.style(e.el,{left:i+"px","max-width":t-i+"px"})}},{key:"_onMouseMove",value:function(e){this.selectedMarker&&(this.dragging||(this.dragging=!0,this.wavesurfer.fireEvent("marker-drag",this.selectedMarker,e)),this.selectedMarker.time=this.wavesurfer.drawer.handleEvent(e)*this.wavesurfer.getDuration(),this._updateMarkerPositions())}},{key:"_onMouseUp",value:function(e){var r=this;if(this.selectedMarker&&setTimeout((function(){r.selectedMarker=!1,r.dragging=!1}),0),this.dragging){e.stopPropagation();var t=this.wavesurfer.getDuration();this.selectedMarker.time=this.wavesurfer.drawer.handleEvent(e)*t,this._updateMarkerPositions(),this.wavesurfer.fireEvent("marker-drop",this.selectedMarker,e)}}},{key:"clear",value:function(){for(;this.markers.length>0;)this.remove(0)}}])&&t(r.prototype,i),a&&t(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();r.default=i,e.exports=r.default}},r={};var t=function t(i){var a=r[i];if(void 0!==a)return a.exports;var n=r[i]={exports:{}};return e[i](n,n.exports,t),n.exports}(188);return t})()}));
//# sourceMappingURL=wavesurfer.markers.min.js.map